{% extends "base.html" %}

{% block title %}All Records - Expense Tracker{% endblock %}

{% block content %}
<!-- All Records Page: View all expense records with filtering by date and category -->
{% include 'nav_menu.html' %}

<div class="container mt-4">
    <h2>All Records</h2>
    
    <!-- Filter Section: Filter expenses by category and date range -->
    <div class="card mt-4 mb-4">
        <div class="card-body">
            <h5 class="card-title">Filter Records</h5>
            <form method="GET" action="{{ url_for('all_records') }}">
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label for="category" class="form-label">Category</label>
                        <select class="form-select" id="category" name="category">
                            <option value="">All Categories</option>
                            <option value="Foods & Drink">Foods & Drink</option>
                            <option value="Shopping">Shopping</option>
                            <option value="Transportation">Transportation</option>
                            <option value="Housing">Housing</option>
                            <option value="Vehicle">Vehicle</option>
                            <option value="Entertainment">Entertainment</option>
                            <option value="Investments">Investments</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="date_from" class="form-label">From Date</label>
                        <input type="date" class="form-control" id="date_from" name="date_from" value="{{ request.args.get('date_from', '') }}">
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="date_to" class="form-label">To Date</label>
                        <input type="date" class="form-control" id="date_to" name="date_to" value="{{ request.args.get('date_to', '') }}">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">Apply Filters</button>
                <a href="{{ url_for('all_records') }}" class="btn btn-secondary">Clear Filters</a>
            </form>
        </div>
    </div>
    
    <!-- Records Table: Display all filtered expense records -->
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Expense Records</h5>
            {% if expenses %}
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Category</th>
                                <th>Amount</th>
                                <th>Description</th>
                                <th>Actions</th>

                            </tr>
                        </thead>
                        <tbody>
                            {% for expense in expenses %}
                            <tr>
                                <td>{{ expense.date[:19] }}</td>
                                <td>{{ expense.category }}</td>
                                <td>{{ "%.2f"|format(expense.amount) }}</td>
                                <td>{{ expense.description or '-' }}</td>
                                <td class="d-flex gap-2">
                                <a href="{{ url_for('edit_expense', expense_id=expense.id) }}"
                                class="btn btn-sm">
                                Edit
                                </a>

                                <form method="POST"
                                    action="{{ url_for('delete_expense', expense_id=expense.id) }}"
                                    onsubmit="return confirm('Delete this expense?');"
                                    style="margin:0;">
                                    <button class="btn btn-sm">
                                        Delete
                                    </button>
                                </form>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p class="text-muted">No records found.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
